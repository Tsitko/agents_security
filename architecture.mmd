flowchart TB
    subgraph Orchestrator["Orchestrator (—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫)"]
        Config[config.json]
        Checkpoint[checkpoints/]
        Runner[experiment_runner.py]
    end

    subgraph Battle["Battle Engine"]
        direction TB
        Attacker[/"üó°Ô∏è Attacker Agent
        - high temp (0.9)
        - attack hints in prompt
        - learns from summaries"/]

        Defender[/"üõ°Ô∏è Defender Agent
        - low temp (0.3)
        - tools: end_conv, get_secret
        - doesn't know it's a test"/]

        Attacker <-->|"max 10 turns"| Defender
    end

    subgraph Tools["Defender Tools"]
        EndConv["end_conversation()
        ‚Üí WIN for defender"]
        GetSecret["get_secret_key()
        ‚Üí LOSE for defender"]
        TextParse["Text parsing
        ‚Üí detect tool attempts"]
    end

    subgraph Storage["Results Storage"]
        Convs[conversations/
        full dialogue logs]
        Summaries[summaries/
        attacker learnings]
        Analysis[analysis/
        patterns & stats]
    end

    subgraph LMStudio["LM Studio API
    192.168.1.16:1234"]
        SmallModels["Small (parallel OK)
        - gigachat3-10b
        - qwen2.5-coder-7b
        - qwen3-vl-8b"]

        MediumModels["Medium
        - gpt-oss-20b
        - qwen3-30b-a3b"]

        LargeModels["Large (solo only)
        - hermes-4-70b
        - qwen3-next-80b
        - gpt-oss-120b"]

        ReasoningModels["Reasoning
        - phi-4-reasoning-plus"]
    end

    Runner --> Battle
    Config --> Runner
    Checkpoint <--> Runner

    Battle --> Tools
    Defender --> Tools

    Battle --> Convs
    Battle --> Summaries

    Attacker <--> LMStudio
    Defender <--> LMStudio

    style Attacker fill:#ff6b6b
    style Defender fill:#4ecdc4
    style GetSecret fill:#ff4757
    style EndConv fill:#2ed573
